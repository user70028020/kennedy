import{f as M,a as x,b as _r}from"../chunks/BVSBLeZ4.js";import{p as Pr,s as c,h as z,c as s,d as a,t as re,g as e,a as qr,b as i,j as Ur,n as ae,r as t,k as Ee}from"../chunks/CyUuy-wj.js";import{d as Vr,e as Gr,s as ur}from"../chunks/Ds7I-RoO.js";import{i as T}from"../chunks/B9KgWSyi.js";import{e as br}from"../chunks/D5Lyc911.js";import{r as v,s as D,b as I}from"../chunks/BUYgxnM0.js";import{a as hr,b}from"../chunks/BZWVT1Ld.js";import{P as Jr}from"../chunks/CMByNPU3.js";import{S as Ne}from"../chunks/DvfD3L-c.js";import{a as fr}from"../chunks/DN5HFw78.js";var Xr=_r('<svg class="w-5 h-5 animate-spin" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Kr=_r('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>'),Qr=M('<button type="button" class="p-1.5 rounded-lg transition-colors" style="color: var(--color-danger);" title="Remover representante"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Wr=M('<div class="p-4 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);"><div class="flex justify-between items-start mb-4"><span class="text-sm font-semibold" style="color: var(--text-secondary);">Representante</span> <!></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"><div class="form-group"><label class="modern-label">Nome</label> <input type="text" class="modern-input" placeholder="Nome do representante"/></div> <div class="form-group"><label class="modern-label">Cargo</label> <input type="text" class="modern-input" placeholder="Cargo"/></div> <div class="form-group"><label class="modern-label">Empresa</label> <input type="text" class="modern-input" placeholder="Empresa"/></div></div> <!></div>'),Yr=M('<button type="button" class="p-2 rounded-lg transition-colors" style="color: var(--color-danger);" title="Remover membro"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Zr=M('<tr style="border-bottom: 1px solid var(--border-color);"><td class="p-3"><input type="text" class="modern-input" placeholder="Nome"/></td><td class="p-3"><input type="text" class="modern-input" placeholder="Função"/></td><td class="p-3"><input type="text" class="modern-input" placeholder="Empresa"/></td><td class="p-3"><!></td></tr>'),ea=M('<div class="modern-alert modern-alert-error animate-in"><svg class="modern-alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),ra=M('<div class="modern-alert modern-alert-success animate-in"><svg class="modern-alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>RDO de Montagem gerado com sucesso! Download iniciado.</span></div>'),aa=M('<div class="loading-dots"><span></span> <span></span> <span></span></div> <span>Gerando Relatório...</span>',1),oa=M('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> <span>Gerar RDO de Montagem</span>',1),ta=M('<div class="max-w-5xl mx-auto animate-in"><div class="modern-card"><div class="modern-card-header"><div class="modern-card-title"><div class="modern-card-title-icon" style="background: var(--gradient-purple);"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> RDO de Montagem</div> <div class="text-sm" style="color: var(--text-muted);">Relatório Diário de Obra</div></div> <form class="space-y-8"><section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Template</h3> <div class="radio-group"><label class="radio-label"><input type="radio" class="modern-radio"/> <span style="color: var(--text-primary);">NX Energy</span></label> <label class="radio-label"><input type="radio" class="modern-radio"/> <span style="color: var(--text-primary);">SERCAMP</span></label></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Informações Gerais</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-5"><div class="form-group"><label for="osNumber" class="modern-label modern-label-required">Número da OS</label> <div class="flex gap-2"><input id="osNumber" type="text" required class="modern-input flex-1" placeholder="Ex: OS-2024-001"/> <button type="button" class="btn-modern btn-modern-secondary px-3" title="Buscar OS"><!></button></div></div> <div class="form-group"><label for="reportDate" class="modern-label">Data</label> <input id="reportDate" type="date" class="modern-input"/></div> <div class="form-group"><label for="projeto" class="modern-label">Projeto</label> <input id="projeto" type="text" class="modern-input" placeholder="Nome do projeto"/></div> <div class="form-group"><label for="clientName" class="modern-label modern-label-required">Cliente</label> <input id="clientName" type="text" required class="modern-input" placeholder="Nome do cliente"/></div> <div class="form-group md:col-span-2"><label for="location" class="modern-label">Local</label> <input id="location" type="text" class="modern-input" placeholder="Local da obra"/></div></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Descrição do Serviço <span style="color: var(--color-danger);">*</span></h3> <textarea rows="4" required class="modern-textarea" placeholder="Descreva o serviço a ser executado..."></textarea></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Representantes</h3> <div class="space-y-4"><!> <button type="button" class="w-full py-3.5 rounded-xl transition-all duration-200 flex items-center justify-center gap-2" style="border: 2px dashed var(--border-color); color: var(--text-muted); background-color: transparent;"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Adicionar Representante</button></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Equipe de Trabalho</h3> <div class="overflow-x-auto rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);"><table class="w-full"><thead><tr style="border-bottom: 1px solid var(--border-color);"><th class="text-left text-sm font-semibold p-3" style="color: var(--text-secondary);">Nome</th><th class="text-left text-sm font-semibold p-3" style="color: var(--text-secondary);">Função</th><th class="text-left text-sm font-semibold p-3" style="color: var(--text-secondary);">Empresa</th><th class="p-3 w-10"></th></tr></thead><tbody></tbody></table></div> <button type="button" class="mt-4 w-full py-3.5 rounded-xl transition-all duration-200 flex items-center justify-center gap-2" style="border: 2px dashed var(--border-color); color: var(--text-muted); background-color: transparent;"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Adicionar Membro da Equipe</button></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Resumo da Jornada de Trabalho</h3> <div class="grid grid-cols-2 md:grid-cols-5 gap-4"><div class="form-group"><label for="inicio" class="modern-label">Início</label> <input id="inicio" type="time" class="modern-input"/></div> <div class="form-group"><label for="intervaloInicio" class="modern-label">Intervalo Início</label> <input id="intervaloInicio" type="time" class="modern-input"/></div> <div class="form-group"><label for="intervaloFim" class="modern-label">Intervalo Fim</label> <input id="intervaloFim" type="time" class="modern-input"/></div> <div class="form-group"><label for="fim" class="modern-label">Fim</label> <input id="fim" type="time" class="modern-input"/></div> <div class="form-group"><label for="horasExtras" class="modern-label">Horas Extras</label> <input id="horasExtras" type="text" class="modern-input" placeholder="Ex: 2h"/></div></div> <div class="mt-4 p-4 rounded-xl flex items-center justify-between" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);"><span class="text-sm" style="color: var(--text-muted);">Total de horas trabalhadas:</span> <span class="text-xl font-bold" style="color: var(--color-primary);"> </span></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Atividades Realizadas</h3> <textarea rows="6" class="modern-textarea" placeholder="Descreva as atividades realizadas durante o dia..."></textarea></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Fotos</h3> <!></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Observações</h3> <textarea rows="4" class="modern-textarea" placeholder="Observações gerais..."></textarea></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Assinaturas Finais</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="p-4 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);"><!></div> <div class="p-4 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);"><!></div></div></section> <!> <!> <div class="flex flex-col sm:flex-row gap-3 pt-4"><button type="submit" class="btn-modern btn-modern-primary flex-1 py-3.5"><!></button> <button type="button" class="btn-modern btn-modern-secondary py-3.5 sm:w-auto"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span>Limpar</span></button></div></form></div></div>');function ba(gr,xr){Pr(xr,!0);const Oe=[],Te="http://localhost:3000/api";let S=c("nx_energy"),C=c(""),L=c(z(new Date().toISOString().split("T")[0])),F=c(""),E=c(""),B=c(""),A=c(""),h=c(z([{id:N(),nome:"",cargo:"",empresa:"",assinatura:""}])),f=c(z([{id:N(),nome:"",funcao:"",empresa:""}])),m=c(z({inicio:"08:00",intervaloInicio:"12:00",intervaloFim:"13:00",fim:"17:00",horasExtras:""})),P=c(""),q=c(z([])),U=c(""),V=c(""),G=c(""),$=c(!1),_=c(null),J=c(!1),X=c(!1);function N(){return`${Date.now()}_${Math.random().toString(36).substring(2,11)}`}function yr(){i(h,[...e(h),{id:N(),nome:"",cargo:"",empresa:"",assinatura:""}],!0)}function kr(r){e(h).length>1&&i(h,e(h).filter(o=>o.id!==r),!0)}function K(r,o,l){i(h,e(h).map(n=>n.id===r?{...n,[o]:l}:n),!0)}function wr(){i(f,[...e(f),{id:N(),nome:"",funcao:"",empresa:""}],!0)}function Mr(r){e(f).length>1&&i(f,e(f).filter(o=>o.id!==r),!0)}function oe(r,o,l){i(f,e(f).map(n=>n.id===r?{...n,[o]:l}:n),!0)}const De=Ur(()=>()=>{try{const[r,o]=e(m).inicio.split(":").map(Number),[l,n]=e(m).intervaloInicio.split(":").map(Number),[y,u]=e(m).intervaloFim.split(":").map(Number),[d,k]=e(m).fim.split(":").map(Number),R=l*60+n-(r*60+o),w=d*60+k-(y*60+u),j=R+w,O=Math.floor(j/60),p=j%60;return`${O}h${p>0?` ${p}min`:""}`}catch{return"0h"}});async function Cr(){if(!e(C).trim()){i(_,"Digite o número da OS para buscar");return}i(X,!0),i(_,null);try{const r=await fetch(`${Te}/admin/service-orders?search=${encodeURIComponent(e(C))}`,{headers:{Authorization:`Bearer ${fr.token}`}});if(r.ok){const o=await r.json();if(o.length>0){const l=o[0];i(E,l.clientName||"",!0),i(B,l.location||"",!0),i(F,l.serviceType||"",!0)}else i(_,"OS não encontrada. Preencha os dados manualmente.")}}catch(r){console.error("Error searching OS:",r)}finally{i(X,!1)}}async function Rr(r){if(r.preventDefault(),i(_,null),i(J,!1),!e(C).trim()){i(_,"Número da OS é obrigatório");return}if(!e(E).trim()){i(_,"Nome do cliente é obrigatório");return}if(!e(A).trim()){i(_,"Descrição do serviço é obrigatória");return}i($,!0);try{const o={template:e(S),osNumber:e(C),reportDate:e(L),projeto:e(F),clientName:e(E),location:e(B),descricaoServico:e(A),representatives:e(h).map(d=>({nome:d.nome,cargo:d.cargo,empresa:d.empresa,assinatura:d.assinatura})),teamMembers:e(f).map(d=>({nome:d.nome,funcao:d.funcao,empresa:d.empresa})),workSchedule:e(m),horasTrabalhadas:e(De)(),atividades:e(P),photos:e(q),observations:e(U),assinaturaResponsavel:e(V),assinaturaCliente:e(G)},l=await fetch(`${Te}/reports/rdo`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${fr.token}`},body:JSON.stringify(o)});if(!l.ok){const d=await l.json();throw new Error(d.message||"Erro ao gerar relatório")}const n=await l.blob(),y=window.URL.createObjectURL(n),u=document.createElement("a");u.href=y,u.download=`rdo_montagem_${e(C)}_${Date.now()}.docx`,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(y),document.body.removeChild(u),i(J,!0),setTimeout(()=>{Ie()},2e3)}catch(o){i(_,o instanceof Error?o.message:"Erro ao gerar relatório",!0)}finally{i($,!1)}}function Ie(){i(S,"nx_energy"),i(C,""),i(L,new Date().toISOString().split("T")[0],!0),i(F,""),i(E,""),i(B,""),i(A,""),i(h,[{id:N(),nome:"",cargo:"",empresa:"",assinatura:""}],!0),i(f,[{id:N(),nome:"",funcao:"",empresa:""}],!0),i(m,{inicio:"08:00",intervaloInicio:"12:00",intervaloFim:"13:00",fim:"17:00",horasExtras:""},!0),i(P,""),i(q,[],!0),i(U,""),i(V,""),i(G,""),i(J,!1),i(_,null)}var te=ta(),Fe=s(te),se=a(s(Fe),2),ie=s(se),Be=a(s(ie),2),le=s(Be),Q=s(le);v(Q),Q.value=Q.__value="nx_energy",ae(2),t(le);var Ae=a(le,2),W=s(Ae);v(W),W.value=W.__value="sercamp",ae(2),t(Ae),t(Be),t(ie);var ne=a(ie,2),$e=a(s(ne),2),de=s($e),He=a(s(de),2),ce=s(He);v(ce);var Y=a(ce,2);Y.__click=Cr;var jr=s(Y);{var Sr=r=>{var o=Xr();x(r,o)},Er=r=>{var o=Kr();x(r,o)};T(jr,r=>{e(X)?r(Sr):r(Er,!1)})}t(Y),t(He),t(de);var ve=a(de,2),ze=a(s(ve),2);v(ze),t(ve);var pe=a(ve,2),Le=a(s(pe),2);v(Le),t(pe);var me=a(pe,2),Pe=a(s(me),2);v(Pe),t(me);var qe=a(me,2),Ue=a(s(qe),2);v(Ue),t(qe),t($e),t(ne);var ue=a(ne,2),Ve=a(s(ue),2);Ee(Ve),t(ue);var be=a(ue,2),Ge=a(s(be),2),Je=s(Ge);br(Je,17,()=>e(h),r=>r.id,(r,o)=>{var l=Wr(),n=s(l),y=a(s(n),2);{var u=g=>{var mr=Qr();mr.__click=()=>kr(e(o).id),x(g,mr)};T(y,g=>{e(h).length>1&&g(u)})}t(n);var d=a(n,2),k=s(d),R=s(k),w=a(R,2);v(w),w.__input=g=>K(e(o).id,"nome",g.currentTarget.value),t(k);var j=a(k,2),O=s(j),p=a(O,2);v(p),p.__input=g=>K(e(o).id,"cargo",g.currentTarget.value),t(j);var H=a(j,2),pr=s(H),ee=a(pr,2);v(ee),ee.__input=g=>K(e(o).id,"empresa",g.currentTarget.value),t(H),t(d);var Lr=a(d,2);Ne(Lr,{label:"Assinatura do Representante",get value(){return e(o).assinatura},onchange:g=>K(e(o).id,"assinatura",g)}),t(l),re(()=>{D(R,"for",`rep-nome-${e(o).id??""}`),D(w,"id",`rep-nome-${e(o).id??""}`),I(w,e(o).nome),D(O,"for",`rep-cargo-${e(o).id??""}`),D(p,"id",`rep-cargo-${e(o).id??""}`),I(p,e(o).cargo),D(pr,"for",`rep-empresa-${e(o).id??""}`),D(ee,"id",`rep-empresa-${e(o).id??""}`),I(ee,e(o).empresa)}),x(r,l)});var Nr=a(Je,2);Nr.__click=yr,t(Ge),t(be);var he=a(be,2),fe=a(s(he),2),Xe=s(fe),Ke=a(s(Xe));br(Ke,21,()=>e(f),r=>r.id,(r,o)=>{var l=Zr(),n=s(l),y=s(n);v(y),y.__input=p=>oe(e(o).id,"nome",p.currentTarget.value),t(n);var u=a(n),d=s(u);v(d),d.__input=p=>oe(e(o).id,"funcao",p.currentTarget.value),t(u);var k=a(u),R=s(k);v(R),R.__input=p=>oe(e(o).id,"empresa",p.currentTarget.value),t(k);var w=a(k),j=s(w);{var O=p=>{var H=Yr();H.__click=()=>Mr(e(o).id),x(p,H)};T(j,p=>{e(f).length>1&&p(O)})}t(w),t(l),re(()=>{I(y,e(o).nome),I(d,e(o).funcao),I(R,e(o).empresa)}),x(r,l)}),t(Ke),t(Xe),t(fe);var Or=a(fe,2);Or.__click=wr,t(he);var _e=a(he,2),ge=a(s(_e),2),xe=s(ge),Qe=a(s(xe),2);v(Qe),t(xe);var ye=a(xe,2),We=a(s(ye),2);v(We),t(ye);var ke=a(ye,2),Ye=a(s(ke),2);v(Ye),t(ke);var we=a(ke,2),Ze=a(s(we),2);v(Ze),t(we);var er=a(we,2),rr=a(s(er),2);v(rr),t(er),t(ge);var ar=a(ge,2),or=a(s(ar),2),Tr=s(or,!0);t(or),t(ar),t(_e);var Me=a(_e,2),tr=a(s(Me),2);Ee(tr),t(Me);var Ce=a(Me,2),Dr=a(s(Ce),2);Jr(Dr,{maxPhotos:30,get photos(){return e(q)},set photos(r){i(q,r,!0)}}),t(Ce);var Re=a(Ce,2),sr=a(s(Re),2);Ee(sr),t(Re);var je=a(Re,2),ir=a(s(je),2),Se=s(ir),Ir=s(Se);Ne(Ir,{label:"Assinatura do Responsável SERCAMP",get value(){return e(V)},set value(r){i(V,r,!0)}}),t(Se);var lr=a(Se,2),Fr=s(lr);Ne(Fr,{label:"Assinatura do Cliente",get value(){return e(G)},set value(r){i(G,r,!0)}}),t(lr),t(ir),t(je);var nr=a(je,2);{var Br=r=>{var o=ea(),l=a(s(o),2),n=s(l,!0);t(l),t(o),re(()=>ur(n,e(_))),x(r,o)};T(nr,r=>{e(_)&&r(Br)})}var dr=a(nr,2);{var Ar=r=>{var o=ra();x(r,o)};T(dr,r=>{e(J)&&r(Ar)})}var cr=a(dr,2),Z=s(cr),$r=s(Z);{var Hr=r=>{var o=aa();ae(2),x(r,o)},zr=r=>{var o=oa();ae(2),x(r,o)};T($r,r=>{e($)?r(Hr):r(zr,!1)})}t(Z);var vr=a(Z,2);vr.__click=Ie,t(cr),t(se),t(Fe),t(te),re(r=>{Y.disabled=e(X),ur(Tr,r),Z.disabled=e($),vr.disabled=e($)},[()=>e(De)()]),Gr("submit",se,Rr),hr(Oe,[],Q,()=>e(S),r=>i(S,r)),hr(Oe,[],W,()=>e(S),r=>i(S,r)),b(ce,()=>e(C),r=>i(C,r)),b(ze,()=>e(L),r=>i(L,r)),b(Le,()=>e(F),r=>i(F,r)),b(Pe,()=>e(E),r=>i(E,r)),b(Ue,()=>e(B),r=>i(B,r)),b(Ve,()=>e(A),r=>i(A,r)),b(Qe,()=>e(m).inicio,r=>e(m).inicio=r),b(We,()=>e(m).intervaloInicio,r=>e(m).intervaloInicio=r),b(Ye,()=>e(m).intervaloFim,r=>e(m).intervaloFim=r),b(Ze,()=>e(m).fim,r=>e(m).fim=r),b(rr,()=>e(m).horasExtras,r=>e(m).horasExtras=r),b(tr,()=>e(P),r=>i(P,r)),b(sr,()=>e(U),r=>i(U,r)),x(gr,te),qr()}Vr(["click","input"]);export{ba as component};

import{f as m,a as v,c as Ie}from"../chunks/BVSBLeZ4.js";import{p as bt,s as _,h as Pe,u as gt,f as Se,d as o,c as a,b as i,g as e,a as _t,r,t as T}from"../chunks/CyUuy-wj.js";import{d as xt,s as u,e as ht}from"../chunks/Ds7I-RoO.js";import{i as y}from"../chunks/B9KgWSyi.js";import{e as De,i as Me}from"../chunks/D5Lyc911.js";import{r as Oe}from"../chunks/BUYgxnM0.js";import{s as yt}from"../chunks/DwPpHslU.js";import{b as Ue}from"../chunks/BZWVT1Ld.js";import{b as de}from"../chunks/axbQqOQH.js";import{b as Ge}from"../chunks/c2Jz6SHd.js";import{a as ce}from"../chunks/CLPOYvp8.js";import{b as wt}from"../chunks/DxC-crzK.js";import{s as kt,f as Ct}from"../chunks/DdEIAL_0.js";var Tt=m("<option> </option>"),qt=m('<div class="bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg animate-fade-in"> </div>'),jt=m('<div class="flex items-center justify-center py-12"><div class="w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),St=m('<div class="text-center py-12 text-theme-muted"><svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p>Nenhum template encontrado</p></div>'),Dt=m('<div class="rounded-lg p-4 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg card-hover" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color); opacity: 0;"><div class="flex items-start justify-between mb-3"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center"><svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h3 class="font-medium text-theme-primary"> </h3> <p class="text-sm text-theme-muted"> </p></div></div> <span> </span></div> <div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-theme-muted">Categoria:</span> <span class="text-theme-secondary"> </span></div> <div class="flex justify-between"><span class="text-theme-muted">Tamanho:</span> <span class="text-theme-secondary"> </span></div> <div class="flex justify-between"><span class="text-theme-muted">Atualizado:</span> <span class="text-theme-secondary"> </span></div></div> <div class="flex items-center justify-end gap-2 mt-4 pt-3" style="border-top: 1px solid var(--border-color);"><button class="p-2 text-theme-muted hover:text-green-400 transition-colors duration-200" title="Download"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></button> <button class="p-2 text-theme-muted hover:text-blue-400 transition-colors duration-200" title="Editar"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="p-2 text-theme-muted hover:text-red-400 transition-colors duration-200" title="Excluir"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>'),Mt=m('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4"></div>'),zt=m("<option> </option>"),Bt=m('<div class="absolute right-3 top-1/2 -translate-y-1/2"><div class="w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),Et=m('<p class="text-green-400 text-sm mt-1"> </p>'),Nt=m('<p class="text-theme-muted text-sm mt-1"> </p>'),Ft=m('<div class="bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg text-sm"> </div>'),Rt=m('<div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>'),At=m('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in"><div class="rounded-lg w-full max-w-md animate-scale-in" style="background-color: var(--bg-card); border: 1px solid var(--border-color);"><div class="flex items-center justify-between p-4" style="border-bottom: 1px solid var(--border-color);"><h2 class="text-xl font-semibold text-theme-primary"> </h2> <button class="text-theme-muted hover:text-theme-primary transition-colors duration-200" aria-label="Fechar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="p-4 space-y-4"><div><label for="name" class="block text-sm font-medium text-theme-secondary mb-1">Nome *</label> <input id="name" type="text" required class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);" placeholder="Nome do template"/></div> <div><label for="templateType" class="block text-sm font-medium text-theme-secondary mb-1">Tipo *</label> <select id="templateType" required class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"><option>Equipamento</option><option>Mesclagem</option></select></div> <div><label for="templateCategory" class="block text-sm font-medium text-theme-secondary mb-1">Categoria *</label> <select id="templateCategory" required class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"><option>Selecione...</option><!></select></div> <div><label for="file" class="block text-sm font-medium text-theme-secondary mb-1"> </label> <div class="relative"><input id="file" type="file" accept=".docx" class="w-full px-3 py-2 rounded-lg transition-colors duration-300 file:mr-4 file:py-1 file:px-3 file:rounded file:border-0 file:bg-blue-600 file:text-white file:cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/> <!></div> <!></div> <!> <div class="flex justify-end gap-3 pt-4" style="border-top: 1px solid var(--border-color);"><button type="button" class="px-4 py-2 rounded-lg transition-all duration-200 hover:scale-105" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Cancelar</button> <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25"><!> </button></div></form></div></div>'),Lt=m('<div class="space-y-6" style="opacity: 0;"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-theme-primary">Templates</h1> <button class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Novo Template</button></div> <div class="rounded-lg p-4 border transition-colors duration-300" style="background-color: var(--bg-card); border-color: var(--border-color);"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div><label for="search" class="block text-sm font-medium mb-1 text-theme-secondary">Buscar</label> <input id="search" type="text" placeholder="Nome, arquivo..." class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/></div> <div><label for="type" class="block text-sm font-medium mb-1 text-theme-secondary">Tipo</label> <select id="type" class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"><option>Todos</option><option>Equipamento</option><option>Mesclagem</option></select></div> <div><label for="category" class="block text-sm font-medium mb-1 text-theme-secondary">Categoria</label> <select id="category" class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"><option>Todas</option><!></select></div> <div class="flex items-end"><button class="px-4 py-2 rounded-lg transition-all duration-200 hover:scale-105" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Limpar Filtros</button></div></div></div> <!> <div class="rounded-lg overflow-hidden border transition-colors duration-300" style="background-color: var(--bg-card); border-color: var(--border-color);"><!></div></div> <!>',1);function Yt(Ke,We){bt(We,!0);let ve=_(Pe([])),ue=_(!0),f=_(""),Y=_(!1),g=_(null),Z=_(!1),E=_(!1),ee,te=[],A=_(""),L=_(""),H=_(""),s=_(Pe({name:"",type:"equipment",category:"",fileName:"",fileData:"",fileSize:0}));const ze=["Transformador","Transformador para Instrumentos","Disjuntor","Para-raios","Relé de Proteção","Chave Seccionadora","Chave Religadora","Painel Religador","Retificador de Bateria","Banco de Capacitores","Cabos","SPDA","Fotográfico","RDO","Gastos"],Be=["Relatório Consolidado","Relatório Final","Outros"];let Ee=_(!1);gt(()=>{wt&&!e(Ee)&&(i(Ee,!0),ee&&Ct(ee,{duration:.4}),q())});async function q(){i(ue,!0),i(f,"");try{const t=new URLSearchParams;e(A)&&t.append("search",e(A)),e(L)&&t.append("type",e(L)),e(H)&&t.append("category",e(H));const n=t.toString(),d=`/admin/templates${n?`?${n}`:""}`;i(ve,await ce.get(d),!0),setTimeout(()=>{te.length>0&&kt(te.filter(Boolean),{duration:.3,stagger:.05})},100)}catch(t){i(f,t instanceof Error?t.message:"Erro ao carregar templates",!0)}finally{i(ue,!1)}}function Xe(){i(g,null),i(s,{name:"",type:"equipment",category:"",fileName:"",fileData:"",fileSize:0},!0),i(Y,!0)}function Je(t){i(g,t,!0),i(s,{name:t.name,type:t.type,category:t.category,fileName:t.fileName,fileData:"",fileSize:t.fileSize},!0),i(Y,!0)}function pe(){i(Y,!1),i(g,null)}async function Qe(t){const d=t.target.files?.[0];if(d){if(!d.name.endsWith(".docx")){i(f,"Apenas arquivos .docx são permitidos");return}i(E,!0);try{const b=new FileReader;b.onload=()=>{const h=b.result.split(",")[1];e(s).fileData=h,e(s).fileName=d.name,e(s).fileSize=d.size,i(E,!1)},b.onerror=()=>{i(f,"Erro ao ler arquivo"),i(E,!1)},b.readAsDataURL(d)}catch{i(f,"Erro ao processar arquivo"),i(E,!1)}}}async function Ye(){if(!e(g)&&!e(s).fileData){i(f,"Selecione um arquivo");return}i(Z,!0),i(f,"");try{const t=e(g)&&!e(s).fileData?{name:e(s).name,type:e(s).type,category:e(s).category}:e(s);e(g)?await ce.put(`/admin/templates/${e(g).id}`,t):await ce.post("/admin/templates",t),pe(),await q()}catch(t){i(f,t instanceof Error?t.message:"Erro ao salvar template",!0)}finally{i(Z,!1)}}async function Ze(t){if(confirm(`Tem certeza que deseja excluir o template "${t.name}"?`))try{await ce.delete(`/admin/templates/${t.id}`),await q()}catch(n){i(f,n instanceof Error?n.message:"Erro ao excluir template",!0)}}function et(t){window.open(`http://localhost:3000/api/admin/templates/${t.id}/download`,"_blank")}function tt(t){return new Date(t).toLocaleDateString("pt-BR")}function Ne(t){return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB"}function rt(t){return t==="equipment"?"Equipamento":"Mesclagem"}function at(t){return t==="equipment"?"bg-blue-500/20 text-blue-400":"bg-purple-500/20 text-purple-400"}let Fe;function ot(){clearTimeout(Fe),Fe=setTimeout(()=>{q()},300)}function it(){return e(s).type==="equipment"?ze:Be}var Re=Lt(),re=Se(Re),me=a(re),lt=o(a(me),2);lt.__click=Xe,r(me);var fe=o(me,2),Ae=a(fe),be=a(Ae),ge=o(a(be),2);Oe(ge),ge.__input=ot,r(be);var _e=o(be,2),ae=o(a(_e),2);ae.__change=q;var xe=a(ae);xe.value=xe.__value="";var he=o(xe);he.value=he.__value="equipment";var Le=o(he);Le.value=Le.__value="merge",r(ae),r(_e);var ye=o(_e,2),oe=o(a(ye),2);oe.__change=q;var we=a(oe);we.value=we.__value="";var st=o(we);De(st,17,()=>[...ze,...Be],Me,(t,n)=>{var d=Tt(),b=a(d,!0);r(d);var h={};T(()=>{u(b,e(n)),h!==(h=e(n))&&(d.value=(d.__value=e(n))??"")}),v(t,d)}),r(oe),r(ye);var He=o(ye,2),nt=a(He);nt.__click=()=>{i(A,""),i(L,""),i(H,""),q()},r(He),r(Ae),r(fe);var Ve=o(fe,2);{var dt=t=>{var n=qt(),d=a(n,!0);r(n),T(()=>u(d,e(f))),v(t,n)};y(Ve,t=>{e(f)&&t(dt)})}var $e=o(Ve,2),ct=a($e);{var vt=t=>{var n=jt();v(t,n)},ut=t=>{var n=Ie(),d=Se(n);{var b=w=>{var j=St();v(w,j)},h=w=>{var j=Mt();De(j,21,()=>e(ve),Me,(V,p,ie)=>{var k=Dt(),C=a(k),S=a(C),$=o(a(S),2),D=a($),I=a(D,!0);r(D);var N=o(D,2),ke=a(N,!0);r(N),r($),r(S);var M=o(S,2),P=a(M,!0);r(M),r(C);var O=o(C,2),z=a(O),U=o(a(z),2),Ce=a(U,!0);r(U),r(z);var G=o(z,2),le=o(a(G),2),Te=a(le,!0);r(le),r(G);var se=o(G,2),K=o(a(se),2),qe=a(K,!0);r(K),r(se),r(O);var W=o(O,2),X=a(W);X.__click=()=>et(e(p));var F=o(X,2);F.__click=()=>Je(e(p));var ne=o(F,2);ne.__click=()=>Ze(e(p)),r(W),r(k),Ge(k,(B,J)=>te[J]=B,B=>te?.[B],()=>[ie]),T((B,J,l,c)=>{u(I,e(p).name),u(ke,e(p).fileName),yt(M,1,`px-2 py-1 rounded-full text-xs font-medium ${B??""}`),u(P,J),u(Ce,e(p).category),u(Te,l),u(qe,c)},[()=>at(e(p).type),()=>rt(e(p).type),()=>Ne(e(p).fileSize),()=>tt(e(p).updatedAt)]),v(V,k)}),r(j),v(w,j)};y(d,w=>{e(ve).length===0?w(b):w(h,!1)},!0)}v(t,n)};y(ct,t=>{e(ue)?t(vt):t(ut,!1)})}r($e),r(re),Ge(re,t=>ee=t,()=>ee);var pt=o(re,2);{var mt=t=>{var n=At(),d=a(n),b=a(d),h=a(b),w=a(h,!0);r(h);var j=o(h,2);j.__click=pe,r(b);var V=o(b,2),p=a(V),ie=o(a(p),2);Oe(ie),r(p);var k=o(p,2),C=o(a(k),2);C.__change=()=>{e(s).category=""};var S=a(C);S.value=S.__value="equipment";var $=o(S);$.value=$.__value="merge",r(C),r(k);var D=o(k,2),I=o(a(D),2),N=a(I);N.value=N.__value="";var ke=o(N);De(ke,17,it,Me,(l,c)=>{var x=zt(),Q=a(x,!0);r(x);var R={};T(()=>{u(Q,e(c)),R!==(R=e(c))&&(x.value=(x.__value=e(c))??"")}),v(l,x)}),r(I),r(D);var M=o(D,2),P=a(M),O=a(P);r(P);var z=o(P,2),U=a(z);U.__change=Qe;var Ce=o(U,2);{var G=l=>{var c=Bt();v(l,c)};y(Ce,l=>{e(E)&&l(G)})}r(z);var le=o(z,2);{var Te=l=>{var c=Et(),x=a(c);r(c),T(Q=>u(x,`✓ ${e(s).fileName??""} (${Q??""})`),[()=>Ne(e(s).fileSize)]),v(l,c)},se=l=>{var c=Ie(),x=Se(c);{var Q=R=>{var je=Nt(),ft=a(je);r(je),T(()=>u(ft,`Arquivo atual: ${e(g).fileName??""}`)),v(R,je)};y(x,R=>{e(g)&&R(Q)},!0)}v(l,c)};y(le,l=>{e(s).fileName&&e(s).fileData?l(Te):l(se,!1)})}r(M);var K=o(M,2);{var qe=l=>{var c=Ft(),x=a(c,!0);r(c),T(()=>u(x,e(f))),v(l,c)};y(K,l=>{e(f)&&l(qe)})}var W=o(K,2),X=a(W);X.__click=pe;var F=o(X,2),ne=a(F);{var B=l=>{var c=Rt();v(l,c)};y(ne,l=>{e(Z)&&l(B)})}var J=o(ne);r(F),r(W),r(V),r(d),r(n),T(()=>{u(w,e(g)?"Editar Template":"Novo Template"),u(O,`Arquivo DOCX ${e(g)?"(opcional)":"*"}`),F.disabled=e(Z)||e(E),u(J,` ${e(g)?"Salvar Alterações":"Criar Template"}`)}),ht("submit",V,l=>{l.preventDefault(),Ye()}),Ue(ie,()=>e(s).name,l=>e(s).name=l),de(C,()=>e(s).type,l=>e(s).type=l),de(I,()=>e(s).category,l=>e(s).category=l),v(t,n)};y(pt,t=>{e(Y)&&t(mt)})}Ue(ge,()=>e(A),t=>i(A,t)),de(ae,()=>e(L),t=>i(L,t)),de(oe,()=>e(H),t=>i(H,t)),v(Ke,Re),_t()}xt(["click","input","change"]);export{Yt as component};

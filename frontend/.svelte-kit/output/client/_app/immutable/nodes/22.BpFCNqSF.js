import{f,a as v,b as we}from"../chunks/BVSBLeZ4.js";import{p as $e,s as i,h as Y,c as s,d as a,t as P,g as r,a as Ve,b as o,n as z,r as n,k as Fe}from"../chunks/CyUuy-wj.js";import{d as Ge,e as Je,s as Z}from"../chunks/Ds7I-RoO.js";import{i as x}from"../chunks/B9KgWSyi.js";import{r as b}from"../chunks/BUYgxnM0.js";import{a as ye,b as y}from"../chunks/BZWVT1Ld.js";import{P as Xe}from"../chunks/CMByNPU3.js";import{E as Ke,S as Qe,D as We}from"../chunks/DTBq4SVp.js";import{a as ke}from"../chunks/DN5HFw78.js";var Ye=we('<svg class="w-5 h-5 animate-spin" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Ze=we('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>'),er=f('<p class="mt-3 text-sm" style="color: var(--color-primary);"><span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full" style="background-color: rgba(59, 130, 246, 0.1);"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> </span></p>'),rr=f('<section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);"> </h3> <!></section>'),or=f('<div class="modern-alert modern-alert-error animate-in"><svg class="modern-alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),ar=f('<div class="modern-alert modern-alert-success animate-in"><svg class="modern-alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Relatório gerado com sucesso! Download iniciado.</span></div>'),tr=f('<div class="loading-dots"><span></span> <span></span> <span></span></div> <span>Gerando Relatório...</span>',1),sr=f('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> <span>Gerar Relatório Técnico</span>',1),nr=f('<div class="max-w-5xl mx-auto animate-in"><div class="modern-card"><div class="modern-card-header"><div class="modern-card-title"><div class="modern-card-title-icon" style="background: var(--gradient-success);"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg></div> Relatório Técnico</div> <div class="text-sm" style="color: var(--text-muted);">Inspeção de Equipamentos</div></div> <form class="space-y-8"><section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Template</h3> <div class="radio-group"><label class="radio-label"><input type="radio" class="modern-radio"/> <span style="color: var(--text-primary);">NX Energy</span></label> <label class="radio-label"><input type="radio" class="modern-radio"/> <span style="color: var(--text-primary);">SERCAMP</span></label></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Informações Básicas</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-5"><div class="form-group"><label for="osNumber" class="modern-label modern-label-required">Número da OS</label> <div class="flex gap-2"><input id="osNumber" type="text" required class="modern-input flex-1" placeholder="Ex: OS-2024-001"/> <button type="button" class="btn-modern btn-modern-secondary px-3" title="Buscar OS"><!></button></div></div> <div class="form-group"><label for="clientName" class="modern-label modern-label-required">Cliente</label> <input id="clientName" type="text" required class="modern-input" placeholder="Nome do cliente"/></div> <div class="form-group"><label for="location" class="modern-label">Local</label> <input id="location" type="text" class="modern-input" placeholder="Local da inspeção"/></div> <div class="form-group"><label for="reportDate" class="modern-label">Data do Relatório</label> <input id="reportDate" type="date" class="modern-input"/></div> <div class="form-group"><label for="responsible" class="modern-label">Responsável</label> <input id="responsible" type="text" class="modern-input" placeholder="Nome do responsável"/></div></div></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Tipo de Equipamento <span style="color: var(--color-danger);">*</span></h3> <!> <!></section> <!> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Status do Equipamento <span style="color: var(--color-danger);">*</span></h3> <!></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Fotos</h3> <!></section> <section><h3 class="text-base font-semibold mb-4 pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Observações</h3> <textarea rows="4" class="modern-textarea" placeholder="Observações gerais sobre a inspeção..."></textarea></section> <!> <!> <div class="flex flex-col sm:flex-row gap-3 pt-4"><button type="submit" class="btn-modern btn-modern-primary flex-1 py-3.5"><!></button> <button type="button" class="btn-modern btn-modern-secondary py-3.5 sm:w-auto"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span>Limpar</span></button></div></form></div></div>');function fr(Se,Ce){$e(Ce,!0);const ee=[],re="http://localhost:3000/api";let h=i("nx_energy"),m=i(""),_=i(""),k=i(""),q=i(Y(new Date().toISOString().split("T")[0])),E=i(""),D=i(""),d=i(null),w=i(Y({})),S=i(""),N=i(Y([])),C=i(!1),c=i(null),O=i(!1),R=i(!1);async function qe(){if(!r(m).trim()){o(c,"Digite o número da OS para buscar");return}o(R,!0),o(c,null);try{const e=await fetch(`${re}/admin/service-orders?search=${encodeURIComponent(r(m))}`,{headers:{Authorization:`Bearer ${ke.token}`}});if(e.ok){const t=await e.json();if(t.length>0){const l=t[0];o(_,l.clientName||"",!0),o(k,l.location||"",!0)}else o(c,"OS não encontrada. Preencha os dados manualmente.")}}catch(e){console.error("Error searching OS:",e)}finally{o(R,!1)}}function Ee(e){o(d,e,!0),o(w,{},!0)}async function De(e){if(e.preventDefault(),o(c,null),o(O,!1),!r(m).trim()){o(c,"Número da OS é obrigatório");return}if(!r(_).trim()){o(c,"Nome do cliente é obrigatório");return}if(!r(d)){o(c,"Selecione o tipo de equipamento");return}if(!r(S)){o(c,"Selecione o status do equipamento");return}o(C,!0);try{const t={template:r(h),osNumber:r(m),clientName:r(_),location:r(k),reportDate:r(q),responsible:r(E),observations:r(D),equipmentType:r(d),status:r(S),formData:r(w),photos:r(N)},l=await fetch(`${re}/reports/tecnico`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke.token}`},body:JSON.stringify(t)});if(!l.ok){const Ue=await l.json();throw new Error(Ue.message||"Erro ao gerar relatório")}const u=await l.blob(),g=window.URL.createObjectURL(u),p=document.createElement("a");p.href=g,p.download=`relatorio_tecnico_${r(d)}_${r(m)}_${Date.now()}.docx`,document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(g),document.body.removeChild(p),o(O,!0),setTimeout(()=>{oe()},2e3)}catch(t){o(c,t instanceof Error?t.message:"Erro ao gerar relatório",!0)}finally{o(C,!1)}}function oe(){o(h,"nx_energy"),o(m,""),o(_,""),o(k,""),o(q,new Date().toISOString().split("T")[0],!0),o(E,""),o(D,""),o(d,null),o(w,{},!0),o(S,""),o(N,[],!0),o(O,!1),o(c,null)}function ae(e){return e?{transformador:"Transformador",transformador_instrumento:"Transformador para Instrumentos",disjuntor:"Disjuntor",para_raio:"Para-raios",rele_protecao:"Relé de Proteção",chave_seccionadora:"Chave Seccionadora",chave_religadora:"Chave Religadora",painel_religador:"Painel Religador",retificador_bateria:"Retificador de Bateria",banco_capacitores:"Banco de Capacitores",cabos:"Cabos",spda:"SPDA"}[e]||e:""}var L=nr(),te=s(L),A=a(s(te),2),H=s(A),se=a(s(H),2),I=s(se),B=s(I);b(B),B.value=B.__value="nx_energy",z(2),n(I);var ne=a(I,2),j=s(ne);b(j),j.value=j.__value="sercamp",z(2),n(ne),n(se),n(H);var U=a(H,2),le=a(s(U),2),$=s(le),ie=a(s($),2),V=s(ie);b(V);var M=a(V,2);M.__click=qe;var Ne=s(M);{var Oe=e=>{var t=Ye();v(e,t)},Re=e=>{var t=Ze();v(e,t)};x(Ne,e=>{r(R)?e(Oe):e(Re,!1)})}n(M),n(ie),n($);var F=a($,2),de=a(s(F),2);b(de),n(F);var G=a(F,2),ce=a(s(G),2);b(ce),n(G);var J=a(G,2),pe=a(s(J),2);b(pe),n(J);var ve=a(J,2),me=a(s(ve),2);b(me),n(ve),n(le),n(U);var X=a(U,2),ue=a(s(X),2);Ke(ue,{required:!0,onchange:Ee,get value(){return r(d)},set value(e){o(d,e,!0)}});var Be=a(ue,2);{var je=e=>{var t=er(),l=s(t),u=a(s(l));n(l),n(t),P(g=>Z(u,` Equipamento selecionado: ${g??""}`),[()=>ae(r(d))]),v(e,t)};x(Be,e=>{r(d)&&e(je)})}n(X);var be=a(X,2);{var Me=e=>{var t=rr(),l=s(t),u=s(l);n(l);var g=a(l,2);We(g,{get equipmentType(){return r(d)},get values(){return r(w)},set values(p){o(w,p,!0)}}),n(t),P(p=>Z(u,`Dados do Equipamento - ${p??""}`),[()=>ae(r(d))]),v(e,t)};x(be,e=>{r(d)&&e(Me)})}var K=a(be,2),Te=a(s(K),2);Qe(Te,{required:!0,get value(){return r(S)},set value(e){o(S,e,!0)}}),n(K);var Q=a(K,2),Pe=a(s(Q),2);Xe(Pe,{maxPhotos:30,get photos(){return r(N)},set photos(e){o(N,e,!0)}}),n(Q);var W=a(Q,2),fe=a(s(W),2);Fe(fe),n(W);var he=a(W,2);{var ze=e=>{var t=or(),l=a(s(t),2),u=s(l,!0);n(l),n(t),P(()=>Z(u,r(c))),v(e,t)};x(he,e=>{r(c)&&e(ze)})}var _e=a(he,2);{var Le=e=>{var t=ar();v(e,t)};x(_e,e=>{r(O)&&e(Le)})}var ge=a(_e,2),T=s(ge),Ae=s(T);{var He=e=>{var t=tr();z(2),v(e,t)},Ie=e=>{var t=sr();z(2),v(e,t)};x(Ae,e=>{r(C)?e(He):e(Ie,!1)})}n(T);var xe=a(T,2);xe.__click=oe,n(ge),n(A),n(te),n(L),P(()=>{M.disabled=r(R),T.disabled=r(C),xe.disabled=r(C)}),Je("submit",A,De),ye(ee,[],B,()=>r(h),e=>o(h,e)),ye(ee,[],j,()=>r(h),e=>o(h,e)),y(V,()=>r(m),e=>o(m,e)),y(de,()=>r(_),e=>o(_,e)),y(ce,()=>r(k),e=>o(k,e)),y(pe,()=>r(q),e=>o(q,e)),y(me,()=>r(E),e=>o(E,e)),y(fe,()=>r(D),e=>o(D,e)),v(Se,L),Ve()}Ge(["click"]);export{fr as component};

import{f as _,a as x,c as ke}from"../chunks/BVSBLeZ4.js";import{p as we,s as v,h as Be,u as Ce,f as X,b as r,d as l,a as je,g as t,c as o,r as a,t as A,k as Ee}from"../chunks/CyUuy-wj.js";import{d as $e,s as h}from"../chunks/Ds7I-RoO.js";import{i as z}from"../chunks/B9KgWSyi.js";import{e as ze,i as De}from"../chunks/D5Lyc911.js";import{r as Se}from"../chunks/BUYgxnM0.js";import{b as Y}from"../chunks/BZWVT1Ld.js";import{b as Z}from"../chunks/c2Jz6SHd.js";import{a as G}from"../chunks/CLPOYvp8.js";import{b as Le}from"../chunks/DxC-crzK.js";import{s as Re,f as Fe}from"../chunks/DdEIAL_0.js";var Ie=_('<div class="bg-red-500/10 border border-red-500/30 rounded-lg p-4 text-red-400 animate-fade-in"> <button class="ml-2 underline hover:no-underline">Fechar</button></div>'),Ne=_('<div class="flex items-center justify-center py-12"><div class="w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),Ue=_('<div class="rounded-lg p-12 text-center border transition-colors duration-300" style="background-color: var(--bg-card); border-color: var(--border-color);"><div class="text-6xl mb-4">ðŸ’¾</div> <h3 class="text-xl font-medium text-theme-primary mb-2">Nenhum backup encontrado</h3> <p class="text-theme-muted mb-4">Crie um backup para proteger seus dados</p> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 hover:scale-105">Criar primeiro backup</button></div>'),Ae=_('<p class="text-theme-muted text-sm"> </p>'),Oe=_('<div class="rounded-lg p-4 flex items-center justify-between border transition-all duration-300 hover:scale-[1.01] card-hover" style="background-color: var(--bg-card); border-color: var(--border-color); opacity: 0;"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-blue-600/20 rounded-lg flex items-center justify-center text-2xl">ðŸ’¾</div> <div><h3 class="text-theme-primary font-medium"> </h3> <!> <div class="flex items-center gap-4 mt-1 text-sm text-theme-muted"><span> </span> <span> </span></div></div></div> <div class="flex items-center gap-2"><button class="px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:opacity-50 text-white text-sm rounded-lg transition-all duration-200 hover:scale-105"> </button> <button class="px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white text-sm rounded-lg transition-all duration-200 hover:scale-105"> </button></div></div>'),Te=_('<div class="grid gap-4"></div>'),Me=_('<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in"><div class="rounded-lg p-6 max-w-md w-full mx-4 animate-scale-in" style="background-color: var(--bg-card); border: 1px solid var(--border-color);"><h3 class="text-xl font-bold text-theme-primary mb-4">ðŸ’¾ Criar Backup</h3> <div class="space-y-4"><div><label for="backup-name" class="block text-sm font-medium text-theme-secondary mb-1">Nome do Backup *</label> <input id="backup-name" type="text" placeholder="Ex: Backup semanal" class="w-full px-3 py-2 rounded-lg transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/></div> <div><label for="backup-description" class="block text-sm font-medium text-theme-secondary mb-1">DescriÃ§Ã£o (opcional)</label> <textarea id="backup-description" placeholder="DescriÃ§Ã£o do backup..." rows="3" class="w-full px-3 py-2 rounded-lg transition-colors duration-300 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"></textarea></div></div> <div class="flex justify-end gap-3 mt-6"><button class="px-4 py-2 rounded-lg transition-all duration-200 hover:scale-105" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Cancelar</button> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded-lg transition-all duration-200 hover:scale-105"> </button></div></div></div>'),qe=_('<div class="space-y-6" style="opacity: 0;"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-theme-primary">ðŸ’¾ Backups</h1> <p class="text-theme-muted mt-1">Gerencie backups do sistema</p></div> <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-200 flex items-center gap-2 hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25"><span>âž•</span> Criar Backup</button></div> <!> <!></div> <!>',1);function et(ee,te){we(te,!0);let y=v(Be([])),O=v(!0),d=v(null),D=v(!1),S=v(null),L=v(null),R,F=[],C=v(!1),k=v(""),j=v(""),K=v(!1);Ce(()=>{Le&&!t(K)&&(r(K,!0),R&&Fe(R,{duration:.4}),re())});async function re(){r(O,!0),r(d,null);try{const e=await G.get("/admin/backups");r(y,e,!0),setTimeout(()=>{F.length>0&&Re(F.filter(Boolean),{duration:.3,stagger:.05})},100)}catch(e){r(d,e.message||"Erro ao carregar backups",!0)}finally{r(O,!1)}}async function ae(){if(!t(k).trim()){r(d,"Nome do backup Ã© obrigatÃ³rio");return}r(D,!0),r(d,null);try{const e=await G.post("/admin/backups",{name:t(k).trim(),description:t(j).trim()||null});r(y,[e,...t(y)],!0),r(C,!1),r(k,""),r(j,"")}catch(e){r(d,e.message||"Erro ao criar backup",!0)}finally{r(D,!1)}}async function oe(e){r(L,e.id,!0);try{const i=await fetch(`http://localhost:3000/api/admin/backups/${e.id}/download`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!i.ok)throw new Error("Erro ao baixar backup");const p=await i.blob(),c=window.URL.createObjectURL(p),n=document.createElement("a");n.href=c,n.download=`backup_${e.name.replace(/\s+/g,"_")}_${new Date(e.createdAt).toISOString().split("T")[0]}.json`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(c),document.body.removeChild(n)}catch(i){r(d,i.message||"Erro ao baixar backup",!0)}finally{r(L,null)}}async function ie(e){if(confirm(`Tem certeza que deseja excluir o backup "${e.name}"?`)){r(S,e.id,!0);try{await G.delete(`/admin/backups/${e.id}`),r(y,t(y).filter(i=>i.id!==e.id),!0)}catch(i){r(d,i.message||"Erro ao excluir backup",!0)}finally{r(S,null)}}}function le(e){return new Date(e).toLocaleString("pt-BR")}function se(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}var H=qe(),I=X(H),T=o(I),ne=l(o(T),2);ne.__click=()=>r(C,!0),a(T);var J=l(T,2);{var de=e=>{var i=Ie(),p=o(i),c=l(p);c.__click=()=>r(d,null),a(i),A(()=>h(p,`${t(d)??""} `)),x(e,i)};z(J,e=>{t(d)&&e(de)})}var ce=l(J,2);{var ue=e=>{var i=Ne();x(e,i)},ve=e=>{var i=ke(),p=X(i);{var c=m=>{var u=Ue(),B=l(o(u),6);B.__click=()=>r(C,!0),a(u),x(m,u)},n=m=>{var u=Te();ze(u,21,()=>t(y),De,(B,s,N)=>{var b=Oe(),E=o(b),g=l(o(E),2),M=o(g),be=o(M,!0);a(M);var P=l(M,2);{var fe=f=>{var w=Ae(),ye=o(w,!0);a(w),A(()=>h(ye,t(s).description)),x(f,w)};z(P,f=>{t(s).description&&f(fe)})}var Q=l(P,2),q=o(Q),xe=o(q);a(q);var V=l(q,2),ge=o(V);a(V),a(Q),a(g),a(E);var W=l(E,2),$=o(W);$.__click=()=>oe(t(s));var he=o($,!0);a($);var U=l($,2);U.__click=()=>ie(t(s));var _e=o(U,!0);a(U),a(W),a(b),Z(b,(f,w)=>F[w]=f,f=>F?.[f],()=>[N]),A((f,w)=>{h(be,t(s).name),h(xe,`ðŸ“… ${f??""}`),h(ge,`ðŸ“¦ ${w??""}`),$.disabled=t(L)===t(s).id,h(he,t(L)===t(s).id?"...":"â¬‡ï¸ Baixar"),U.disabled=t(S)===t(s).id,h(_e,t(S)===t(s).id?"...":"ðŸ—‘ï¸ Excluir")},[()=>le(t(s).createdAt),()=>se(t(s).fileSize)]),x(B,b)}),a(u),x(m,u)};z(p,m=>{t(y).length===0?m(c):m(n,!1)},!0)}x(e,i)};z(ce,e=>{t(O)?e(ue):e(ve,!1)})}a(I),Z(I,e=>R=e,()=>R);var pe=l(I,2);{var me=e=>{var i=Me(),p=o(i),c=l(o(p),2),n=o(c),m=l(o(n),2);Se(m),a(n);var u=l(n,2),B=l(o(u),2);Ee(B),a(u),a(c);var s=l(c,2),N=o(s);N.__click=()=>{r(C,!1),r(k,""),r(j,"")};var b=l(N,2);b.__click=ae;var E=o(b,!0);a(b),a(s),a(p),a(i),A(g=>{b.disabled=g,h(E,t(D)?"Criando...":"Criar Backup")},[()=>t(D)||!t(k).trim()]),Y(m,()=>t(k),g=>r(k,g)),Y(B,()=>t(j),g=>r(j,g)),x(e,i)};z(pe,e=>{t(C)&&e(me)})}x(ee,H),je()}$e(["click"]);export{et as component};

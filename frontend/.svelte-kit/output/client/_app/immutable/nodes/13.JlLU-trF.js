import{f as p,a as v,c as ce,b as ve}from"../chunks/BVSBLeZ4.js";import{p as ue,s as u,h as me,u as pe,d as o,c as r,t as P,g as e,a as xe,b as s,r as a,f as Bt}from"../chunks/CyUuy-wj.js";import{d as fe,s as d}from"../chunks/Ds7I-RoO.js";import{i as R}from"../chunks/B9KgWSyi.js";import{e as Ft,i as At}from"../chunks/D5Lyc911.js";import{r as ut,s as be}from"../chunks/BUYgxnM0.js";import{s as ge}from"../chunks/DwPpHslU.js";import{b as mt}from"../chunks/BZWVT1Ld.js";import{b as he}from"../chunks/axbQqOQH.js";import{b as Ct}from"../chunks/c2Jz6SHd.js";import{a as Et}from"../chunks/CLPOYvp8.js";import{b as ye}from"../chunks/DxC-crzK.js";import{s as _e,f as we}from"../chunks/DdEIAL_0.js";var ke=p("<option> </option>"),De=p('<div class="bg-red-500/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg animate-fade-in"> </div>'),Te=p('<div class="flex items-center justify-center py-12"><div class="w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),Se=p('<div class="text-center py-12 text-theme-muted"><svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p>Nenhum relatório encontrado</p></div>'),Me=p('<div class="w-5 h-5 border-2 border-red-400 border-t-transparent rounded-full animate-spin"></div>'),Be=ve('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>'),Fe=p('<tr class="transition-colors duration-200 hover:bg-theme-hover" style="opacity: 0;"><td class="px-4 py-3"><span> </span></td><td class="px-4 py-3 text-theme-primary font-medium"> </td><td class="px-4 py-3 text-theme-secondary"> </td><td class="px-4 py-3 text-theme-secondary text-sm truncate max-w-[200px]"> </td><td class="px-4 py-3 text-theme-muted text-sm"> </td><td class="px-4 py-3 text-theme-muted text-sm"> </td><td class="px-4 py-3 text-theme-muted text-sm"> </td><td class="px-4 py-3 text-theme-muted text-sm"> </td><td class="px-4 py-3"><div class="flex items-center justify-end gap-2"><button class="p-2 text-theme-muted hover:text-green-400 transition-colors" title="Download"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></button> <button class="p-2 text-theme-muted hover:text-red-400 transition-colors disabled:opacity-50" title="Excluir"><!></button></div></td></tr>'),Ae=p('<div class="flex items-center justify-between px-4 py-3" style="border-top: 1px solid var(--border-color);"><div class="text-sm text-theme-muted"> </div> <div class="flex items-center gap-2"><button class="px-3 py-1 rounded transition-all disabled:opacity-50 disabled:cursor-not-allowed" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Anterior</button> <span class="text-theme-muted"> </span> <button class="px-3 py-1 rounded transition-all disabled:opacity-50 disabled:cursor-not-allowed" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Próxima</button></div></div>'),Ce=p('<div class="overflow-x-auto"><table class="w-full"><thead style="background-color: var(--bg-tertiary);"><tr><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Tipo</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">OS</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Cliente</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Arquivo</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Template</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Tamanho</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Gerado por</th><th class="px-4 py-3 text-left text-sm font-medium text-theme-secondary">Data</th><th class="px-4 py-3 text-right text-sm font-medium text-theme-secondary">Ações</th></tr></thead><tbody class="divide-y" style="border-color: var(--border-color);"></tbody></table></div> <!>',1),Ee=p('<div class="space-y-6" style="opacity: 0;"><div class="flex items-center justify-between"><h1 class="text-2xl font-bold text-theme-primary">Banco de Relatórios</h1> <div class="text-theme-muted text-sm"> </div></div> <div class="rounded-lg p-4 border" style="background-color: var(--bg-card); border-color: var(--border-color);"><div class="grid grid-cols-1 md:grid-cols-5 gap-4"><div><label for="search" class="block text-sm font-medium text-theme-secondary mb-1">Buscar</label> <input id="search" type="text" placeholder="OS, cliente, arquivo..." class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/></div> <div><label for="type" class="block text-sm font-medium text-theme-secondary mb-1">Tipo</label> <select id="type" class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"><option>Todos</option><!></select></div> <div><label for="startDate" class="block text-sm font-medium text-theme-secondary mb-1">Data Início</label> <input id="startDate" type="date" class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/></div> <div><label for="endDate" class="block text-sm font-medium text-theme-secondary mb-1">Data Fim</label> <input id="endDate" type="date" class="w-full px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" style="background-color: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-primary);"/></div> <div class="flex items-end"><button class="px-4 py-2 rounded-lg transition-all duration-200 hover:scale-105" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Limpar Filtros</button></div></div></div> <!> <div class="rounded-lg overflow-hidden border" style="background-color: var(--bg-card); border-color: var(--border-color);"><!></div></div>');function Ke(Nt,Pt){ue(Pt,!0);let H=u(me([])),x=u(0),K=u(!0),k=u(""),$=u(null),j,L=[],D=u(""),T=u(""),S=u(""),M=u(""),n=u(1),B=20;const pt=[{value:"fotografico",label:"Fotográfico"},{value:"tecnico",label:"Técnico"},{value:"spda",label:"SPDA"},{value:"rdo",label:"RDO de Montagem"},{value:"gastos",label:"Gastos"},{value:"mesclado",label:"Mesclado"}];let xt=u(!1);pe(()=>{ye&&!e(xt)&&(s(xt,!0),j&&we(j,{duration:.4}),g())});async function g(){s(K,!0),s(k,"");try{const t=new URLSearchParams;e(D)&&t.append("search",e(D)),e(T)&&t.append("type",e(T)),e(S)&&t.append("startDate",e(S)),e(M)&&t.append("endDate",e(M)),t.append("limit",B.toString()),t.append("offset",((e(n)-1)*B).toString());const l=await Et.get(`/reports${t.toString()?`?${t}`:""}`);s(H,l.reports,!0),s(x,l.total,!0),setTimeout(()=>{L.length>0&&_e(L.filter(Boolean),{duration:.2,stagger:.03})},100)}catch(t){s(k,t instanceof Error?t.message:"Erro ao carregar relatórios",!0)}finally{s(K,!1)}}async function Rt(t){if(confirm(`Excluir "${t.fileName}"?`)){s($,t.id,!0);try{await Et.delete(`/reports/${t.id}`),await g()}catch(l){s(k,l instanceof Error?l.message:"Erro ao excluir relatório",!0)}finally{s($,null)}}}function $t(t){window.open(`http://localhost:3000/api/reports/${t.id}/download`,"_blank")}function jt(t){return new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function Lt(t){return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB"}function zt(t){return pt.find(l=>l.value===t)?.label||t}function It(t){return{fotografico:"bg-green-500/20 text-green-400",tecnico:"bg-blue-500/20 text-blue-400",spda:"bg-yellow-500/20 text-yellow-400",rdo:"bg-purple-500/20 text-purple-400",gastos:"bg-orange-500/20 text-orange-400",mesclado:"bg-pink-500/20 text-pink-400"}[t]||"bg-gray-500/20 text-gray-400"}function Vt(t){return{nx_energy:"NX Energy",sercamp:"SERCAMP",merge:"Mesclagem"}[t]||t}let ft;function Ot(){clearTimeout(ft),ft=setTimeout(()=>{s(n,1),g()},300)}function U(){s(n,1),g()}function qt(){s(D,""),s(T,""),s(S,""),s(M,""),s(n,1),g()}function X(){return Math.ceil(e(x)/B)}function bt(t){s(n,t,!0),g()}var z=Ee(),J=r(z),gt=o(r(J),2),Gt=r(gt);a(gt),a(J);var Q=o(J,2),ht=r(Q),W=r(ht),Y=o(r(W),2);ut(Y),Y.__input=Ot,a(W);var Z=o(W,2),I=o(r(Z),2);I.__change=U;var tt=r(I);tt.value=tt.__value="";var Ht=o(tt);Ft(Ht,17,()=>pt,At,(t,l)=>{var m=ke(),lt=r(m,!0);a(m);var V={};P(()=>{d(lt,e(l).label),V!==(V=e(l).value)&&(m.value=(m.__value=e(l).value)??"")}),v(t,m)}),a(I),a(Z);var et=o(Z,2),at=o(r(et),2);ut(at),at.__change=U,a(et);var rt=o(et,2),ot=o(r(rt),2);ut(ot),ot.__change=U,a(rt);var yt=o(rt,2),Kt=r(yt);Kt.__click=qt,a(yt),a(ht),a(Q);var _t=o(Q,2);{var Ut=t=>{var l=De(),m=r(l,!0);a(l),P(()=>d(m,e(k))),v(t,l)};R(_t,t=>{e(k)&&t(Ut)})}var wt=o(_t,2),Xt=r(wt);{var Jt=t=>{var l=Te();v(t,l)},Qt=t=>{var l=ce(),m=Bt(l);{var lt=h=>{var O=Se();v(h,O)},V=h=>{var O=Ce(),st=Bt(O),kt=r(st),Dt=o(r(kt));Ft(Dt,21,()=>e(H),At,(F,i,A)=>{var y=Fe(),_=r(y),f=r(_),C=r(f,!0);a(f),a(_);var E=o(_),q=r(E,!0);a(E);var N=o(E),it=r(N,!0);a(N);var w=o(N),Zt=r(w,!0);a(w);var dt=o(w),te=r(dt,!0);a(dt);var nt=o(dt),ee=r(nt,!0);a(nt);var ct=o(nt),ae=r(ct,!0);a(ct);var vt=o(ct),re=r(vt,!0);a(vt);var Tt=o(vt),St=r(Tt),Mt=r(St);Mt.__click=()=>$t(e(i));var G=o(Mt,2);G.__click=()=>Rt(e(i));var oe=r(G);{var le=c=>{var b=Me();v(c,b)},se=c=>{var b=Be();v(c,b)};R(oe,c=>{e($)===e(i).id?c(le):c(se,!1)})}a(G),a(St),a(Tt),a(y),Ct(y,(c,b)=>L[b]=c,c=>L?.[c],()=>[A]),P((c,b,ie,de,ne)=>{ge(f,1,`px-2 py-1 rounded-full text-xs font-medium ${c??""}`),d(C,b),d(q,e(i).osNumber),d(it,e(i).clientName),be(w,"title",e(i).fileName),d(Zt,e(i).fileName),d(te,ie),d(ee,de),d(ae,e(i).generatedBy?.name||"N/A"),d(re,ne),G.disabled=e($)===e(i).id},[()=>It(e(i).type),()=>zt(e(i).type),()=>Vt(e(i).template),()=>Lt(e(i).fileSize),()=>jt(e(i).createdAt)]),v(F,y)}),a(Dt),a(kt),a(st);var Wt=o(st,2);{var Yt=F=>{var i=Ae(),A=r(i),y=r(A);a(A);var _=o(A,2),f=r(_);f.__click=()=>bt(e(n)-1);var C=o(f,2),E=r(C);a(C);var q=o(C,2);q.__click=()=>bt(e(n)+1),a(_),a(i),P((N,it,w)=>{d(y,`Mostrando ${(e(n)-1)*B+1} a ${N??""} de ${e(x)??""}`),f.disabled=e(n)===1,d(E,`Página ${e(n)??""} de ${it??""}`),q.disabled=w},[()=>Math.min(e(n)*B,e(x)),X,()=>e(n)>=X()]),v(F,i)};R(Wt,F=>{X()>1&&F(Yt)})}v(h,O)};R(m,h=>{e(H).length===0?h(lt):h(V,!1)},!0)}v(t,l)};R(Xt,t=>{e(K)?t(Jt):t(Qt,!1)})}a(wt),a(z),Ct(z,t=>j=t,()=>j),P(()=>d(Gt,`${e(x)??""} relatório${e(x)!==1?"s":""} encontrado${e(x)!==1?"s":""}`)),mt(Y,()=>e(D),t=>s(D,t)),he(I,()=>e(T),t=>s(T,t)),mt(at,()=>e(S),t=>s(S,t)),mt(ot,()=>e(M),t=>s(M,t)),v(Nt,z),xe()}fe(["input","change","click"]);export{Ke as component};

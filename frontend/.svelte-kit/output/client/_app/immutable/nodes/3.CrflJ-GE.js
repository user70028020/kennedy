import{f as u,a as n,b as je,c as Ae,t as fr}from"../chunks/BVSBLeZ4.js";import{p as er,c as a,g as e,r,d as t,t as q,f as de,a as rr,u as ir,s as v,b as s,n as He,k as br,h as gr}from"../chunks/CyUuy-wj.js";import{i as y}from"../chunks/B9KgWSyi.js";import{s as xr}from"../chunks/yBHeIKn2.js";import{a as lr}from"../chunks/DN5HFw78.js";import{g as sr}from"../chunks/VH3MxTbr.js";import{b as _r}from"../chunks/DxC-crzK.js";import{p as hr,H as yr}from"../chunks/CeoiFMeb.js";import{i as kr}from"../chunks/DG4n1pGD.js";import{s as w,d as vr,e as P}from"../chunks/Ds7I-RoO.js";import{e as Ee,i as Re}from"../chunks/D5Lyc911.js";import{s as wr,r as he,b as cr}from"../chunks/BUYgxnM0.js";import{s as dr}from"../chunks/DwPpHslU.js";import{s as Ze}from"../chunks/SJb4weSm.js";import{s as Sr,a as Cr}from"../chunks/Ds5fY43x.js";import"../chunks/CMByNPU3.js";import"../chunks/DTBq4SVp.js";import"../chunks/DvfD3L-c.js";import{b as Te}from"../chunks/BZWVT1Ld.js";import{b as zr,i as Or,s as Mr}from"../chunks/axbQqOQH.js";import{p as Tr}from"../chunks/k3Q1lqoc.js";import{a as $e}from"../chunks/CLPOYvp8.js";var Ar=je('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'),Er=je('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>'),Rr=je('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path></svg>'),jr=je('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),Pr=je('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),Nr=u('<span class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-blue-500"></span>'),Fr=u('<a><span><!></span> <span class="hidden sm:inline"> </span> <span class="sm:hidden"> </span> <!></a>'),Dr=u('<nav class="px-4 py-3 border-b" style="background-color: var(--bg-card); border-color: var(--border-color);"><div class="max-w-7xl mx-auto"><div class="flex justify-center"><div class="inline-flex p-1 rounded-2xl gap-1" style="background-color: var(--bg-secondary);"></div></div></div></nav>');function Lr(ve,_){er(_,!1);const G=()=>Cr(hr,"$page",x),[x,m]=Sr(),O=[{id:"fotografico",label:"Relatório Fotográfico",shortLabel:"Fotográfico",href:"/relatorios/fotografico",module:"fotografico",icon:"camera"},{id:"spda",label:"SPDA",shortLabel:"SPDA",href:"/relatorios/spda",module:"spda",icon:"lightning"},{id:"rdo",label:"RDO de Montagem",shortLabel:"RDO",href:"/relatorios/rdo",module:"rdo",icon:"wrench"},{id:"tecnico",label:"Relatório Técnico",shortLabel:"Técnico",href:"/relatorios/tecnico",module:"tecnico",icon:"document"},{id:"gastos",label:"Relatório de Gastos",shortLabel:"Gastos",href:"/relatorios/gastos",module:"gastos",icon:"currency"}];function b(){return O.filter(N=>lr.hasModule(N.module))}function k(N){return G().url.pathname.startsWith(N)}kr();var M=Dr(),W=a(M),K=a(W),Q=a(K);Ee(Q,5,b,Re,(N,p)=>{var T=Fr(),S=a(T),X=a(S);{var h=o=>{var d=Ar();n(o,d)},A=o=>{var d=Ae(),E=de(d);{var H=C=>{var j=Er();n(C,j)},R=C=>{var j=Ae(),f=de(j);{var I=U=>{var le=Rr();n(U,le)},pe=U=>{var le=Ae(),F=de(le);{var L=i=>{var Y=jr();n(i,Y)},c=i=>{var Y=Ae(),Pe=de(Y);{var ie=ne=>{var me=Pr();n(ne,me)};y(Pe,ne=>{e(p).icon==="currency"&&ne(ie)},!0)}n(i,Y)};y(F,i=>{e(p).icon==="document"?i(L):i(c,!1)},!0)}n(U,le)};y(f,U=>{e(p).icon==="wrench"?U(I):U(pe,!1)},!0)}n(C,j)};y(E,C=>{e(p).icon==="lightning"?C(H):C(R,!1)},!0)}n(o,d)};y(X,o=>{e(p).icon==="camera"?o(h):o(A,!1)})}r(S);var g=t(S,2),$=a(g,!0);r(g);var ee=t(g,2),se=a(ee,!0);r(ee);var re=t(ee,2);{var ue=o=>{var d=Nr();n(o,d)};y(re,o=>{k(e(p).href)&&o(ue)})}r(T),q((o,d,E)=>{wr(T,"href",e(p).href),dr(T,1,`group relative flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-300 ${o??""}`),Ze(T,d),dr(S,1,`transition-transform duration-300 ${E??""}`),w($,e(p).label),w(se,e(p).shortLabel)},[()=>k(e(p).href)?"shadow-lg":"hover:bg-opacity-50",()=>k(e(p).href)?"background-color: var(--bg-card); color: var(--text-primary); box-shadow: 0 4px 12px rgba(0,0,0,0.1);":"color: var(--text-muted); background-color: transparent;",()=>k(e(p).href)?"scale-110":"group-hover:scale-110"]),n(N,T)}),r(Q),r(K),r(W),r(M),n(ve,M),rr(),m()}var Br=u('<div class="p-6 text-center"><div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: rgba(16, 185, 129, 0.2);"><svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <h3 class="text-lg font-semibold mb-2" style="color: var(--text-primary);">Pesquisa Enviada!</h3> <p style="color: var(--text-muted);">Obrigado pelo seu feedback.</p></div>'),Vr=u('<div class="modern-alert-error"> </div>'),qr=u("<option> </option>"),Gr=u('<button type="button" class="w-10 h-10 rounded-lg font-semibold transition"> </button>'),Hr=u('<div class="flex items-center justify-between"><span style="color: var(--text-secondary);"> <span class="text-red-500">*</span></span> <div class="flex gap-2"></div></div>'),Ir=u('<div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div> Enviando...',1),Ur=u('<form class="p-6 space-y-6"><!> <div><label for="osNumber" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Número da OS <span class="text-red-500">*</span></label> <input id="osNumber" type="text" placeholder="Ex: OS-2024-001" class="modern-input"/></div> <div class="space-y-4"><h3 class="text-lg font-semibold pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Dados do Cliente</h3> <div><label for="razaoSocial" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Razão Social <span class="text-red-500">*</span></label> <input id="razaoSocial" type="text" placeholder="Nome da empresa" class="modern-input"/></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="responsavel" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Responsável <span class="text-red-500">*</span></label> <input id="responsavel" type="text" placeholder="Nome do responsável" class="modern-input"/></div> <div><label for="telefone" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Telefone <span class="text-red-500">*</span></label> <input id="telefone" type="tel" placeholder="(00) 00000-0000" maxlength="15" class="modern-input"/></div></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="col-span-2 md:col-span-2"><label for="cidade" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Cidade <span class="text-red-500">*</span></label> <input id="cidade" type="text" placeholder="Cidade" class="modern-input"/></div> <div><label for="uf" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">UF <span class="text-red-500">*</span></label> <select id="uf" class="modern-select"><option>UF</option><!></select></div> <div><label for="cep" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">CEP <span class="text-red-500">*</span></label> <input id="cep" type="text" placeholder="00000-000" maxlength="9" class="modern-input"/></div></div> <div><label for="endereco" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Endereço <span class="text-red-500">*</span></label> <input id="endereco" type="text" placeholder="Rua, número, bairro" class="modern-input"/></div></div> <div class="space-y-4"><h3 class="text-lg font-semibold pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Avaliação do Serviço</h3> <p class="text-sm" style="color: var(--text-muted);">Avalie de 1 (ruim) a 5 (excelente)</p> <!></div> <div class="space-y-4"><h3 class="text-lg font-semibold pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Recomendação</h3> <div><p class="mb-3" style="color: var(--text-secondary);">Você recomendaria a SERCAMP? <span class="text-red-500">*</span></p> <div class="flex gap-4"><button type="button" class="flex-1 py-3 rounded-lg font-semibold transition">SIM</button> <button type="button" class="flex-1 py-3 rounded-lg font-semibold transition">NÃO</button></div></div></div> <div class="space-y-4"><h3 class="text-lg font-semibold pb-2" style="color: var(--text-primary); border-bottom: 1px solid var(--border-color);">Sugestões / Reclamações</h3> <div><label for="sugestoes" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Deixe seu comentário (opcional)</label> <textarea id="sugestoes" rows="4" placeholder="Suas sugestões, reclamações ou comentários..." class="modern-textarea"></textarea></div></div> <div class="flex gap-3 justify-end pt-4" style="border-top: 1px solid var(--border-color);"><button type="button" class="px-4 py-2 rounded-lg transition disabled:opacity-50" style="background-color: var(--bg-tertiary); color: var(--text-secondary);">Cancelar</button> <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 flex items-center gap-2"><!></button></div></form>'),Jr=u('<div class="fixed inset-0 flex items-center justify-center z-50 p-4 overflow-y-auto" style="background-color: rgba(0, 0, 0, 0.6);"><div class="rounded-lg w-full max-w-2xl my-8 max-h-[90vh] overflow-y-auto" style="background-color: var(--bg-secondary);"><div class="sticky top-0 px-6 py-4 flex items-center justify-between" style="background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-color);"><h2 class="text-xl font-bold" style="color: var(--text-primary);">Pesquisa de Satisfação</h2> <button class="transition" style="color: var(--text-muted);" aria-label="Fechar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div></div>');function Wr(ve,_){er(_,!0);let G=Tr(_,"osNumber",3,""),x=v(!1),m=v(""),O=v(!1),b=v(""),k=v(""),M=v(""),W=v(""),K=v(""),Q=v(""),N=v(""),p=v("");ir(()=>{G()&&!e(p)&&s(p,G())});let T=v(0),S=v(0),X=v(0),h=v(0),A=v(0),g=v(null),$=v("");const ee=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],se=[{key:"atendimento",label:"Atendimento"},{key:"apresentacao",label:"Apresentação"},{key:"prazo",label:"Prazo"},{key:"competencia",label:"Competência"},{key:"confiabilidade",label:"Confiabilidade"}];function re(c){switch(c){case"atendimento":return e(T);case"apresentacao":return e(S);case"prazo":return e(X);case"competencia":return e(h);case"confiabilidade":return e(A);default:return 0}}function ue(c,i){switch(c){case"atendimento":s(T,i,!0);break;case"apresentacao":s(S,i,!0);break;case"prazo":s(X,i,!0);break;case"competencia":s(h,i,!0);break;case"confiabilidade":s(A,i,!0);break}}function o(c){const i=c.replace(/\D/g,"");return i.length<=5?i:`${i.slice(0,5)}-${i.slice(5,8)}`}function d(c){const i=c.replace(/\D/g,"");return i.length<=2?i:i.length<=7?`(${i.slice(0,2)}) ${i.slice(2)}`:`(${i.slice(0,2)}) ${i.slice(2,7)}-${i.slice(7,11)}`}function E(c){const i=c.target;s(Q,o(i.value),!0)}function H(c){const i=c.target;s(M,d(i.value),!0)}function R(){return e(p).trim()?e(b).trim()?e(k).trim()?e(M).trim()?e(W).trim()?e(K)?e(Q).trim()?e(N).trim()?e(T)===0||e(S)===0||e(X)===0||e(h)===0||e(A)===0?(s(m,"Todas as avaliações são obrigatórias"),!1):e(g)===null?(s(m,"Por favor, responda se recomendaria a SERCAMP"),!1):!0:(s(m,"Endereço é obrigatório"),!1):(s(m,"CEP é obrigatório"),!1):(s(m,"UF é obrigatório"),!1):(s(m,"Cidade é obrigatória"),!1):(s(m,"Telefone é obrigatório"),!1):(s(m,"Nome do responsável é obrigatório"),!1):(s(m,"Razão Social é obrigatória"),!1):(s(m,"Número da OS é obrigatório"),!1)}async function C(){if(s(m,""),!!R()){s(x,!0);try{await $e.post("/reports/pesquisa",{osNumber:e(p),razaoSocial:e(b),responsavel:e(k),telefone:e(M),cidade:e(W),uf:e(K),cep:e(Q),endereco:e(N),atendimento:e(T),apresentacao:e(S),prazo:e(X),competencia:e(h),confiabilidade:e(A),recomendaria:e(g),sugestoes:e($).trim()||null}),s(O,!0),_.onSuccess?.(),setTimeout(()=>{_.onClose()},2e3)}catch(c){s(m,c instanceof Error?c.message:"Erro ao enviar pesquisa",!0)}finally{s(x,!1)}}}function j(c){c.target===c.currentTarget&&_.onClose()}var f=Jr();f.__click=j;var I=a(f),pe=a(I),U=t(a(pe),2);U.__click=function(...c){_.onClose?.apply(this,c)},r(pe);var le=t(pe,2);{var F=c=>{var i=Br();n(c,i)},L=c=>{var i=Ur(),Y=a(i);{var Pe=l=>{var z=Vr(),D=a(z,!0);r(z),q(()=>w(D,e(m))),n(l,z)};y(Y,l=>{e(m)&&l(Pe)})}var ie=t(Y,2),ne=t(a(ie),2);he(ne),r(ie);var me=t(ie,2),ae=t(a(me),2),J=t(a(ae),2);he(J),r(ae);var B=t(ae,2),te=a(B),ce=t(a(te),2);he(ce),r(te);var Ie=t(te,2),fe=t(a(Ie),2);he(fe),fe.__input=H,r(Ie),r(B);var ye=t(B,2),Ne=a(ye),ke=t(a(Ne),2);he(ke),r(Ne);var we=t(Ne,2),Fe=t(a(we),2),be=a(Fe);be.value=be.__value="";var Ue=t(be);Ee(Ue,17,()=>ee,Re,(l,z)=>{var D=qr(),Ve=a(D,!0);r(D);var Me={};q(()=>{w(Ve,e(z)),Me!==(Me=e(z))&&(D.value=(D.__value=e(z))??"")}),n(l,D)}),r(Fe),r(we);var Je=t(we,2),Se=t(a(Je),2);he(Se),Se.__input=E,r(Je),r(ye);var De=t(ye,2),We=t(a(De),2);he(We),r(De),r(me);var Ce=t(me,2),Le=t(a(Ce),4);Ee(Le,17,()=>se,Re,(l,z)=>{let D=()=>e(z).key,Ve=()=>e(z).label;var Me=Hr(),or=a(Me),ur=a(or);He(),r(or);var nr=t(or,2);Ee(nr,20,()=>[1,2,3,4,5],Re,(pr,qe)=>{var _e=Gr();_e.__click=()=>ue(D(),qe);var mr=a(_e,!0);r(_e),q(Ge=>{Ze(_e,Ge),w(mr,qe)},[()=>re(D())===qe?"background-color: #3b82f6; color: white;":"background-color: var(--bg-tertiary); color: var(--text-muted);"]),P("mouseenter",_e,Ge=>{re(D())!==qe&&(Ge.currentTarget.style.backgroundColor="var(--bg-hover)")}),P("mouseleave",_e,Ge=>{re(D())!==qe&&(Ge.currentTarget.style.backgroundColor="var(--bg-tertiary)")}),n(pr,_e)}),r(nr),r(Me),q(()=>w(ur,`${Ve()??""} `)),n(l,Me)}),r(Ce);var Be=t(Ce,2),Ke=t(a(Be),2),Qe=t(a(Ke),2),ge=a(Qe);ge.__click=()=>s(g,!0);var V=t(ge,2);V.__click=()=>s(g,!1),r(Qe),r(Ke),r(Be);var Z=t(Be,2),Xe=t(a(Z),2),ze=t(a(Xe),2);br(ze),r(Xe),r(Z);var Oe=t(Z,2),oe=a(Oe);oe.__click=function(...l){_.onClose?.apply(this,l)};var xe=t(oe,2),ar=a(xe);{var Ye=l=>{var z=Ir();He(),n(l,z)},tr=l=>{var z=fr("Enviar Pesquisa");n(l,z)};y(ar,l=>{e(x)?l(Ye):l(tr,!1)})}r(xe),r(Oe),r(i),q(()=>{cr(fe,e(M)),cr(Se,e(Q)),Ze(ge,e(g)===!0?"background-color: #10b981; color: white;":"background-color: var(--bg-tertiary); color: var(--text-muted);"),Ze(V,e(g)===!1?"background-color: #ef4444; color: white;":"background-color: var(--bg-tertiary); color: var(--text-muted);"),oe.disabled=e(x),xe.disabled=e(x)}),P("submit",i,l=>{l.preventDefault(),C()}),Te(ne,()=>e(p),l=>s(p,l)),Te(J,()=>e(b),l=>s(b,l)),Te(ce,()=>e(k),l=>s(k,l)),Te(ke,()=>e(W),l=>s(W,l)),zr(Fe,()=>e(K),l=>s(K,l)),Te(We,()=>e(N),l=>s(N,l)),P("mouseenter",ge,l=>{e(g)!==!0&&(l.currentTarget.style.backgroundColor="var(--bg-hover)")}),P("mouseleave",ge,l=>{e(g)!==!0&&(l.currentTarget.style.backgroundColor="var(--bg-tertiary)")}),P("mouseenter",V,l=>{e(g)!==!1&&(l.currentTarget.style.backgroundColor="var(--bg-hover)")}),P("mouseleave",V,l=>{e(g)!==!1&&(l.currentTarget.style.backgroundColor="var(--bg-tertiary)")}),Te(ze,()=>e($),l=>s($,l)),P("mouseenter",oe,l=>!e(x)&&(l.currentTarget.style.backgroundColor="var(--bg-hover)")),P("mouseleave",oe,l=>!e(x)&&(l.currentTarget.style.backgroundColor="var(--bg-tertiary)")),n(c,i)};y(le,c=>{e(O)?c(F):c(L,!1)})}r(I),r(f),P("mouseenter",U,c=>c.currentTarget.style.color="var(--text-primary)"),P("mouseleave",U,c=>c.currentTarget.style.color="var(--text-muted)"),n(ve,f),rr()}vr(["click","input"]);var Kr=u('<div class="flex items-center justify-center py-8"><div class="w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),Qr=u('<div class="modern-alert-success"><div class="flex items-center gap-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> </div></div>'),Xr=u('<div class="modern-alert-error"> </div>'),Yr=u('<div class="text-center py-8" style="color: var(--text-muted);"><svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p>Nenhuma ordem de serviço ativa encontrada.</p> <p class="text-sm mt-2">Solicite ao administrador para criar uma nova OS.</p></div>'),Zr=u("<option> </option>"),$r=u('<div class="flex items-center justify-between rounded px-3 py-2 text-sm" style="background-color: var(--bg-hover);"><div class="flex items-center gap-2"><span class="px-2 py-0.5 bg-blue-600 rounded text-xs text-white"> </span> <span class="truncate max-w-[200px]" style="color: var(--text-secondary);"> </span></div> <span class="text-xs" style="color: var(--text-muted);"> </span></div>'),ea=u('<div class="space-y-2 max-h-40 overflow-y-auto"></div>'),ra=u('<div class="modern-alert-warning">⚠️ Nenhum relatório gerado para esta OS. Gere pelo menos um relatório antes de finalizar.</div>'),aa=u('<div class="rounded-lg p-4 space-y-3" style="background-color: var(--bg-tertiary);"><h3 class="font-medium" style="color: var(--text-primary);">Detalhes da OS</h3> <div class="grid grid-cols-2 gap-3 text-sm"><div><span style="color: var(--text-muted);">Cliente:</span> <span class="ml-2" style="color: var(--text-primary);"> </span></div> <div><span style="color: var(--text-muted);">Líder:</span> <span class="ml-2" style="color: var(--text-primary);"> </span></div> <div><span style="color: var(--text-muted);">Equipamento:</span> <span class="ml-2" style="color: var(--text-primary);"> </span></div> <div><span style="color: var(--text-muted);">Local:</span> <span class="ml-2" style="color: var(--text-primary);"> </span></div> <div><span style="color: var(--text-muted);">Período:</span> <span class="ml-2" style="color: var(--text-primary);"> </span></div></div> <div class="mt-4"><h4 class="text-sm font-medium mb-2" style="color: var(--text-secondary);"> </h4> <!></div></div>'),ta=u('<div class="space-y-4"><div><label for="os-select" class="block text-sm font-medium mb-2" style="color: var(--text-secondary);">Selecione a Ordem de Serviço</label> <select id="os-select" class="modern-select"><option>-- Selecione uma OS --</option><!></select></div> <!> <div class="modern-alert-info"><div class="flex gap-2"><svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div><p class="font-medium">Ao finalizar a OS:</p> <ul class="mt-1 list-disc list-inside space-y-1"><li>O status será alterado para "Concluída"</li> <li>Os relatórios ficarão disponíveis para mesclagem no painel admin</li> <li>Não será possível gerar novos relatórios para esta OS</li></ul></div></div></div></div>'),oa=u("<!> <!>",1),sa=u('<div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div> Finalizando...',1),la=je('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Finalizar OS',1),ia=u('<div class="flex items-center justify-end gap-3 p-4" style="border-top: 1px solid var(--border-color);"><button class="px-4 py-2 transition" style="color: var(--text-secondary);">Cancelar</button> <button class="px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded font-medium transition flex items-center gap-2"><!></button></div>'),na=u('<div class="fixed inset-0 flex items-center justify-center z-50 p-4" style="background-color: rgba(0, 0, 0, 0.7);" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden" style="background-color: var(--bg-secondary);"><div class="flex items-center justify-between p-4" style="border-bottom: 1px solid var(--border-color);"><h2 id="modal-title" class="text-xl font-semibold" style="color: var(--text-primary);">Finalizar Ordem de Serviço</h2> <button class="transition" style="color: var(--text-muted);" aria-label="Fechar"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 overflow-y-auto max-h-[calc(90vh-140px)]"><!></div> <!></div></div>');function ca(ve,_){er(_,!0);let G=v(!0),x=v(!1),m=v(gr([])),O=v(""),b=v(null),k=v(""),M=v("");ir(()=>{W()});async function W(){try{s(G,!0),s(k,"");const o=await $e.get("/reports/service-orders");s(m,o,!0)}catch(o){s(k,o instanceof Error?o.message:"Erro ao carregar ordens de serviço",!0)}finally{s(G,!1)}}async function K(o){if(!o){s(b,null);return}try{const d=await $e.get(`/reports/service-orders/${o}/reports`);s(b,{...d.serviceOrder,reports:d.reports,_count:{reports:d.reportCount}},!0)}catch(d){console.error("Error loading OS details:",d)}}function Q(o){const d=o.target;s(O,d.value,!0),K(d.value)}async function N(){if(!e(O)){s(k,"Selecione uma ordem de serviço");return}try{s(x,!0),s(k,"");const o=await $e.post("/reports/finalizar-os",{osNumber:e(O)});s(M,`${o.message}. ${o.reportCount} relatório(s) disponível(is) para mesclagem.`),setTimeout(()=>{_.onSuccess?.(),_.onClose()},2e3)}catch(o){s(k,o instanceof Error?o.message:"Erro ao finalizar ordem de serviço",!0)}finally{s(x,!1)}}function p(o){return new Date(o).toLocaleDateString("pt-BR")}function T(o){return{fotografico:"Fotográfico",tecnico:"Técnico",spda:"SPDA",rdo:"RDO",gastos:"Gastos",mesclado:"Mesclado"}[o]||o}var S=na();S.__click=o=>o.target===o.currentTarget&&_.onClose(),S.__keydown=o=>o.key==="Escape"&&_.onClose();var X=a(S),h=a(X),A=t(a(h),2);A.__click=function(...o){_.onClose?.apply(this,o)},r(h);var g=t(h,2),$=a(g);{var ee=o=>{var d=Kr();n(o,d)},se=o=>{var d=Ae(),E=de(d);{var H=C=>{var j=Qr(),f=a(j),I=t(a(f));r(f),r(j),q(()=>w(I,` ${e(M)??""}`)),n(C,j)},R=C=>{var j=oa(),f=de(j);{var I=F=>{var L=Xr(),c=a(L,!0);r(L),q(()=>w(c,e(k))),n(F,L)};y(f,F=>{e(k)&&F(I)})}var pe=t(f,2);{var U=F=>{var L=Yr();n(F,L)},le=F=>{var L=ta(),c=a(L),i=t(a(c),2);i.__change=Q;var Y=a(i);Y.value=Y.__value="";var Pe=t(Y);Ee(Pe,17,()=>e(m),Re,(ae,J)=>{var B=Zr(),te=a(B);r(B);var ce={};q(()=>{w(te,`${e(J).osNumber??""} - ${e(J).clientName??""} (${(e(J)._count?.reports||0)??""} relatórios)`),ce!==(ce=e(J).osNumber)&&(B.value=(B.__value=e(J).osNumber)??"")}),n(ae,B)}),r(i);var ie;Or(i),r(c);var ne=t(c,2);{var me=ae=>{var J=aa(),B=t(a(J),2),te=a(B),ce=t(a(te),2),Ie=a(ce,!0);r(ce),r(te);var fe=t(te,2),ye=t(a(fe),2),Ne=a(ye,!0);r(ye),r(fe);var ke=t(fe,2),we=t(a(ke),2),Fe=a(we,!0);r(we),r(ke);var be=t(ke,2),Ue=t(a(be),2),Je=a(Ue,!0);r(Ue),r(be);var Se=t(be,2),De=t(a(Se),2),We=a(De);r(De),r(Se),r(B);var Ce=t(B,2),Le=a(Ce),Be=a(Le);r(Le);var Ke=t(Le,2);{var Qe=V=>{var Z=ea();Ee(Z,21,()=>e(b).reports,Re,(Xe,ze)=>{var Oe=$r(),oe=a(Oe),xe=a(oe),ar=a(xe,!0);r(xe);var Ye=t(xe,2),tr=a(Ye,!0);r(Ye),r(oe);var l=t(oe,2),z=a(l,!0);r(l),r(Oe),q((D,Ve)=>{w(ar,D),w(tr,e(ze).fileName),w(z,Ve)},[()=>T(e(ze).type),()=>p(e(ze).createdAt)]),n(Xe,Oe)}),r(Z),n(V,Z)},ge=V=>{var Z=ra();n(V,Z)};y(Ke,V=>{e(b).reports&&e(b).reports.length>0?V(Qe):V(ge,!1)})}r(Ce),r(J),q((V,Z)=>{w(Ie,e(b).clientName),w(Ne,e(b).teamLeader),w(Fe,e(b).equipmentType),w(Je,e(b).location),w(We,`${V??""} - ${Z??""}`),w(Be,`Relatórios Gerados (${(e(b).reports?.length||0)??""})`)},[()=>p(e(b).periodStart),()=>p(e(b).periodEnd)]),n(ae,J)};y(ne,ae=>{e(b)&&ae(me)})}He(2),r(L),q(()=>{ie!==(ie=e(O))&&(i.value=(i.__value=e(O))??"",Mr(i,e(O)))}),n(F,L)};y(pe,F=>{e(m).length===0?F(U):F(le,!1)})}n(C,j)};y(E,C=>{e(M)?C(H):C(R,!1)},!0)}n(o,d)};y($,o=>{e(G)?o(ee):o(se,!1)})}r(g);var re=t(g,2);{var ue=o=>{var d=ia(),E=a(d);E.__click=function(...f){_.onClose?.apply(this,f)};var H=t(E,2);H.__click=N;var R=a(H);{var C=f=>{var I=sa();He(),n(f,I)},j=f=>{var I=la();He(),n(f,I)};y(R,f=>{e(x)?f(C):f(j,!1)})}r(H),r(d),q(()=>{E.disabled=e(x),H.disabled=!e(O)||e(x)||e(b)?.reports?.length===0}),P("mouseenter",E,f=>!e(x)&&(f.currentTarget.style.color="var(--text-primary)")),P("mouseleave",E,f=>!e(x)&&(f.currentTarget.style.color="var(--text-secondary)")),n(o,d)};y(re,o=>{!e(G)&&!e(M)&&e(m).length>0&&o(ue)})}r(X),r(S),P("mouseenter",A,o=>o.currentTarget.style.color="var(--text-primary)"),P("mouseleave",A,o=>o.currentTarget.style.color="var(--text-muted)"),n(ve,S),rr()}vr(["click","keydown","change"]);var da=u('<div class="min-h-screen flex items-center justify-center" style="background-color: var(--bg-primary);"><div class="flex flex-col items-center gap-4"><div class="w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div> <p class="text-theme-muted">Carregando...</p></div></div>'),va=u('<div class="min-h-screen flex flex-col" style="background-color: var(--bg-primary);"><!> <!> <main class="flex-1 p-4 md:p-6"><div class="max-w-7xl mx-auto"><!></div></main></div> <!> <!>',1);function Pa(ve,_){er(_,!0);let G=v(!0),x=v(!1),m=v(!1),O=v(!1);ir(()=>{_r&&!e(O)&&(s(O,!0),b())});async function b(){try{if(!lr.token){sr("/login");return}if(!await lr.checkAuth()){sr("/login");return}s(G,!1)}catch(h){console.error("Auth check failed:",h),sr("/login")}}function k(){s(x,!0)}function M(){s(x,!1)}function W(){console.log("Pesquisa de satisfação enviada com sucesso")}function K(){s(m,!0)}function Q(){s(m,!1)}function N(){console.log("OS finalizada com sucesso")}var p=Ae(),T=de(p);{var S=h=>{var A=da();n(h,A)},X=h=>{var A=va(),g=de(A),$=a(g);yr($,{onSurvey:k,onFinalizeOS:K});var ee=t($,2);Lr(ee,{});var se=t(ee,2),re=a(se),ue=a(re);xr(ue,()=>_.children),r(re),r(se),r(g);var o=t(g,2);{var d=R=>{Wr(R,{onClose:M,onSuccess:W})};y(o,R=>{e(x)&&R(d)})}var E=t(o,2);{var H=R=>{ca(R,{onClose:Q,onSuccess:N})};y(E,R=>{e(m)&&R(H)})}n(h,A)};y(T,h=>{e(G)?h(S):h(X,!1)})}n(ve,p),rr()}export{Pa as component};

import{c as E,a as d,f as h}from"../chunks/BVSBLeZ4.js";import{p as I,u as V,f as B,a as H,g as r,s as m,b as t,c as g,d as v,r as p,t as K}from"../chunks/CyUuy-wj.js";import{s as M}from"../chunks/Ds7I-RoO.js";import{i as x}from"../chunks/B9KgWSyi.js";import{s as O}from"../chunks/yBHeIKn2.js";import{b as q}from"../chunks/c2Jz6SHd.js";import{a as o}from"../chunks/DN5HFw78.js";import{g as s}from"../chunks/VH3MxTbr.js";import{b as k}from"../chunks/DxC-crzK.js";import{A as D}from"../chunks/CeoiFMeb.js";import"../chunks/DG4n1pGD.js";import{f as w}from"../chunks/DdEIAL_0.js";var F=h('<div class="min-h-screen flex items-center justify-center" style="background-color: var(--bg-primary);"><div class="flex flex-col items-center gap-4"><div class="relative"><div class="w-12 h-12 border-4 border-blue-500/30 rounded-full"></div> <div class="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin absolute top-0 left-0"></div></div> <p class="text-theme-secondary">Verificando autenticação...</p></div></div>'),G=h('<div class="mb-4 px-4 py-3 rounded-lg bg-yellow-500/20 border border-yellow-500/50 text-yellow-400 text-sm flex items-center gap-2"><svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> </div>'),J=h('<div class="min-h-screen flex" style="background-color: var(--bg-primary);"><!> <main class="flex-1 p-6 overflow-auto" style="background-color: var(--bg-primary);"><!> <!></main></div>');function to(U,y){I(y,!0);let l=m(!0),c=m(null),i=m(void 0),A=m(!1);console.log("[Admin Layout] Script loaded, browser:",k),V(()=>{if(!(r(A)||!k)){if(t(A,!0),console.log("[Admin Layout] Effect running"),console.log("[Admin Layout] Token:",!!o.token),console.log("[Admin Layout] User:",o.user?.name),console.log("[Admin Layout] IsAdmin:",o.isAdmin),!o.token){console.log("[Admin Layout] No token, redirecting to login"),s("/login");return}if(o.user&&o.isAdmin){console.log("[Admin Layout] Has cached admin user, showing page"),t(l,!1),setTimeout(()=>{r(i)&&w(r(i),{duration:.4})},50);return}if(o.user&&!o.isAdmin){console.log("[Admin Layout] User is not admin, redirecting"),s("/relatorios");return}console.log("[Admin Layout] Verifying with server..."),o.checkAuth().then(e=>{if(console.log("[Admin Layout] Auth result:",e),!e){console.log("[Admin Layout] Auth failed, redirecting to login"),s("/login");return}if(!o.isAdmin){console.log("[Admin Layout] Not admin, redirecting to relatorios"),s("/relatorios");return}console.log("[Admin Layout] Auth OK, showing page"),t(l,!1),setTimeout(()=>{r(i)&&w(r(i),{duration:.4})},50)}).catch(e=>{console.error("[Admin Layout] Auth error:",e),o.user&&o.isAdmin?(console.log("[Admin Layout] Using cached admin data"),t(l,!1),t(c,"Servidor indisponível. Usando dados em cache.")):(console.log("[Admin Layout] No cached data, redirecting to login"),s("/login"))})}});var b=E(),N=B(b);{var S=e=>{var a=F();d(e,a)},T=e=>{var a=J(),L=g(a);D(L,{});var u=v(L,2),_=g(u);{var j=n=>{var f=G(),C=v(g(f));p(f),K(()=>M(C,` ${r(c)??""}`)),d(n,f)};x(_,n=>{r(c)&&n(j)})}var z=v(_,2);O(z,()=>y.children),p(u),q(u,n=>t(i,n),()=>r(i)),p(a),d(e,a)};x(N,e=>{r(l)?e(S):e(T,!1)})}d(U,b),H()}export{to as component};
